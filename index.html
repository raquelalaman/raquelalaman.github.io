<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code thinking</title>
    <meta name="description" content="Blog personal">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Marked.js para procesar markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.2/marked.min.js"></script>
    
    <!-- Highlight.js para sintaxis de código -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/lib/highlight.min.js"></script>
</head>
<body>
    <header>
        <nav>
            <div class="nav-content">
                <ul class="nav-links">
                    <li><a href="https://raquelalaman.github.io/">Inici</a></li>
                    <li><a href="#about">Qui soc</a></li>
                    <li><a href="#">Projectes</a></li> 
                    <li><a href="blog.html">Blog</a></li>                    
                    <li><a href="#contact">Contacte</a></li>
                </ul>
            </div>
        </nav>
        <div class="logo">
            <a href="https://raquelalaman.github.io/"><img src="assets/images/logo.png" alt="Logo"/></a>
        </div>
        <div class="header-content">
            <h1><a href="https://raquelalaman.github.io/">Code thinking</a></h1>
            <p class="subtitle">Explorant idees i compartint coneixement</p>
        </div>
    </header>
    <main>
        <!-- Secció Qui soc -->
        <section class="about-section" id="about">
            <div class="about-content">
                <div class="about-text">
                    <h2>Qui soc?</h2>
                    <p>De les dades a la innovació. Del coneixement al futur.</p>
                    <p>Combino la meva experiència en docència en formació professional d’informàtica amb la investigació tecnològica d’avantguarda, contribuint tant a la innovació com a la formació del talent digital del futur. Forma part de la comunitat!</p>
                    <a href="#" class="about-btn">Coneix-me!</a>
                </div>
                <div class="about-image">
                    <img src="assets/images/coneix-me.jpg" alt="Qui soc">
                </div>
            </div>
        </section>
        <!-- Secció Projectes -->
        <section class="projects-section" id="projects">
            <h2 class="section-title">Projectes</h2>
            <p class="section-subtitle">Coneix els diferents projectes en els quals he estat col·laborant.</p>
            <div class="projects-grid">
                <article class="project-card">
                    <div class="project-image">
                        <img src="assets/images/project1.jpg" alt="Projecte 1">
                        <div class="project-overlay">
                            <h3>Nom del Projecte</h3>
                            <p>Breu descripció</p>
                        </div>
                    </div>
                </article>
                <article class="project-card">
                    <div class="project-image">
                        <img src="assets/images/project2.jpg" alt="Projecte 2">
                        <div class="project-overlay">
                            <h3>Nom del Projecte</h3>
                            <p>Breu descripció</p>
                        </div>
                    </div>
                </article>
                <article class="project-card">
                    <div class="project-image">
                        <img src="assets/images/project3.jpg" alt="Projecte 3">
                        <div class="project-overlay">
                            <h3>Nom del Projecte</h3>
                            <p>Breu descripció</p>
                        </div>
                    </div>
                </article>
            </div>
        </section>
        <!-- Secció Blog -->
        <section class="blog-section" id="blog">
            <h2 class="section-title">Reflexions digitals</h2>
            <p class="section-subtitle">Descobreix les meves últimes reflexions sobre els reptes i oportunitats que planteja la transformació digital en àmbits com la investigació, l’educació i el desenvolupament tecnològic.</p>
            <div class="blog-posts" id="posts-container">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>     
    </main>

    <footer>
        <div class="footer-content">
            <div class="social-links">
                <a href="#" title="GitHub">GH</a>
                <a href="#" title="Twitter">TW</a>
                <a href="#" title="LinkedIn">IN</a>
                <a href="#" title="Email">@</a>
            </div>
            <p>&copy; 2025 Mi Blog. Creado con GitHub Pages.</p>
        </div>
    </footer>

    <script>
    // Configuració dels posts
    const postsDirectory = 'posts/';
    const postFiles = [
        '2025-11-08-chatgpt5.md',
        '2024-01-12-guia-markdown.md',
        '2024-01-10-css-grid-flexbox.md'
    ];
    
    let blogPosts = [];

    // Funció per parsear el front matter YAML
    function parseFrontMatter(content) {
        const frontMatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
        const match = content.match(frontMatterRegex);
        
        if (!match) {
            return { frontMatter: {}, content: content };
        }
        
        const frontMatterText = match[1];
        const markdownContent = match[2];
        const frontMatter = {};
        
        frontMatterText.split('\n').forEach(line => {
            const colonIndex = line.indexOf(':');
            if (colonIndex > 0) {
                const key = line.substring(0, colonIndex).trim();
                const value = line.substring(colonIndex + 1).trim().replace(/^["']|["']$/g, '');
                frontMatter[key] = value;
            }
        });
        
        return { frontMatter, content: markdownContent };
    }

    // Funció per extreure excerpt del contingut
    function extractExcerpt(content, maxLength = 150) {
        let plainText = content
            .replace(/^#{1,6}\s+/gm, '')
            .replace(/\*\*(.*?)\*\*/g, '$1')
            .replace(/\*(.*?)\*/g, '$1')
            .replace(/`(.*?)`/g, '$1')
            .replace(/\[(.*?)\]\(.*?\)/g, '$1')
            .replace(/^\s*[-*+]\s+/gm, '')
            .replace(/^\s*\d+\.\s+/gm, '')
            .replace(/\n\s*\n/g, ' ')
            .trim();
        
        if (plainText.length > maxLength) {
            plainText = plainText.substring(0, maxLength) + '...';
        }
        
        return plainText;
    }

    // Funció per carregar un fitxer markdown
    async function loadMarkdownFile(filename) {
        try {
            const response = await fetch(postsDirectory + filename);
            if (!response.ok) {
                console.error(`Error carregant ${filename}: ${response.status}`);
                return null;
            }
            
            const content = await response.text();
            const { frontMatter, content: markdownContent } = parseFrontMatter(content);
            
            const dateMatch = filename.match(/^(\d{4}-\d{2}-\d{2})/);
            const date = frontMatter.date || (dateMatch ? dateMatch[1] : new Date().toISOString().split('T')[0]);
            
            const slug = filename.replace(/^\d{4}-\d{2}-\d{2}-/, '').replace(/\.md$/, '');
            
            // Generar imatge per defecte basada en el títol
            const defaultImage = `https://via.placeholder.com/400x250/6065FF/ffffff?text=${encodeURIComponent(frontMatter.title || 'Post')}`;
            
            return {
                slug,
                title: frontMatter.title || slug.replace(/-/g, ' '),
                date: date,
                author: frontMatter.author || 'Autor',
                category: frontMatter.tags ? frontMatter.tags.split(',')[0].trim() : 'General',
                tags: frontMatter.tags ? frontMatter.tags.split(',').map(t => t.trim()) : [],
                image: frontMatter.image || defaultImage,
                excerpt: frontMatter.excerpt || extractExcerpt(markdownContent),
                content: markdownContent,
                filename: filename
            };
        } catch (error) {
            console.error(`Error carregant ${filename}:`, error);
            return null;
        }
    }

    // Funció per carregar tots els posts
    async function loadAllPosts() {
        const container = document.getElementById('posts-container');
        container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
        
        try {
            const promises = postFiles.map(loadMarkdownFile);
            const posts = await Promise.all(promises);
            
            blogPosts = posts
                .filter(post => post !== null)
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 6); // Mostrar només els 6 primers
            
            renderPosts();
        } catch (error) {
            console.error('Error carregant posts:', error);
            container.innerHTML = `
                <div class="post-card" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                    <h3>Error carregant els posts</h3>
                    <p>Assegura't que els fitxers markdown existeixen a la carpeta <code>posts/</code></p>
                </div>
            `;
        }
    }

    // Funció per renderitzar posts
    function renderPosts() {
        const container = document.getElementById('posts-container');
        container.innerHTML = '';

        if (blogPosts.length === 0) {
            container.innerHTML = `
                <div class="post-card" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                    <h3>No hi ha posts disponibles</h3>
                    <p>Afegeix fitxers markdown a la carpeta posts/</p>
                </div>
            `;
            return;
        }

        blogPosts.forEach((post, index) => {
            const postElement = document.createElement('article');
            postElement.className = 'post-card fade-in';
            postElement.style.animationDelay = `${index * 0.1}s`;
            
            postElement.innerHTML = `
                <div class="post-image">
                    <img src="${post.image}" alt="${post.title}" 
                         onerror="this.src='https://via.placeholder.com/400x250/6065FF/ffffff?text=Post'">
                </div>
                <div class="post-content">
                    <div class="post-meta">
                        <span class="post-tag">${post.category}</span>
                        <span class="post-date">${formatDate(post.date)}</span>
                    </div>
                    <h3 class="post-title">${post.title}</h3>
                    <p class="post-excerpt">${post.excerpt}</p>
                    <a href="post.html?slug=${post.slug}" class="read-more">Read more</a>
                </div>
            `;

            container.appendChild(postElement);
        });
    }

    // Funció per formatar data
    function formatDate(dateString) {
        const date = new Date(dateString);
        const months = [
            'Gener', 'Febrer', 'Març', 'Abril', 'Maig', 'Juny',
            'Juliol', 'Agost', 'Setembre', 'Octubre', 'Novembre', 'Desembre'
        ];
        
        return `${date.getDate()} ${months[date.getMonth()]}, ${date.getFullYear()}`;
    }

    // Funcionalitat de navegació suau
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Inicialitzar la pàgina
    document.addEventListener('DOMContentLoaded', () => {
        loadAllPosts();
    });
</script>
</body>
</html>
